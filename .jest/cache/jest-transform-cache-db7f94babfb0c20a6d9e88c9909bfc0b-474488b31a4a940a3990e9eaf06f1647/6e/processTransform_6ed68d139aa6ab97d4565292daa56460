b4c742b376bb50e4a268559b6ad6a287
'use strict';

var MatrixMath = require('../Utilities/MatrixMath');
var Platform = require('../Utilities/Platform');
var invariant = require('invariant');
var stringifySafe = require('../Utilities/stringifySafe').default;
function processTransform(transform) {
  if (__DEV__) {
    _validateTransforms(transform);
  }
  if (Platform.OS === 'android' || Platform.OS === 'ios') {
    return transform;
  }
  var result = MatrixMath.createIdentityMatrix();
  transform.forEach(function (transformation) {
    var key = Object.keys(transformation)[0];
    var value = transformation[key];
    switch (key) {
      case 'matrix':
        MatrixMath.multiplyInto(result, result, value);
        break;
      case 'perspective':
        _multiplyTransform(result, MatrixMath.reusePerspectiveCommand, [value]);
        break;
      case 'rotateX':
        _multiplyTransform(result, MatrixMath.reuseRotateXCommand, [_convertToRadians(value)]);
        break;
      case 'rotateY':
        _multiplyTransform(result, MatrixMath.reuseRotateYCommand, [_convertToRadians(value)]);
        break;
      case 'rotate':
      case 'rotateZ':
        _multiplyTransform(result, MatrixMath.reuseRotateZCommand, [_convertToRadians(value)]);
        break;
      case 'scale':
        _multiplyTransform(result, MatrixMath.reuseScaleCommand, [value]);
        break;
      case 'scaleX':
        _multiplyTransform(result, MatrixMath.reuseScaleXCommand, [value]);
        break;
      case 'scaleY':
        _multiplyTransform(result, MatrixMath.reuseScaleYCommand, [value]);
        break;
      case 'translate':
        _multiplyTransform(result, MatrixMath.reuseTranslate3dCommand, [value[0], value[1], value[2] || 0]);
        break;
      case 'translateX':
        _multiplyTransform(result, MatrixMath.reuseTranslate2dCommand, [value, 0]);
        break;
      case 'translateY':
        _multiplyTransform(result, MatrixMath.reuseTranslate2dCommand, [0, value]);
        break;
      case 'skewX':
        _multiplyTransform(result, MatrixMath.reuseSkewXCommand, [_convertToRadians(value)]);
        break;
      case 'skewY':
        _multiplyTransform(result, MatrixMath.reuseSkewYCommand, [_convertToRadians(value)]);
        break;
      default:
        throw new Error('Invalid transform name: ' + key);
    }
  });
  return result;
}
function _multiplyTransform(result, matrixMathFunction, args) {
  var matrixToApply = MatrixMath.createIdentityMatrix();
  var argsWithIdentity = [matrixToApply].concat(args);
  matrixMathFunction.apply(this, argsWithIdentity);
  MatrixMath.multiplyInto(result, result, matrixToApply);
}
function _convertToRadians(value) {
  var floatValue = parseFloat(value);
  return value.indexOf('rad') > -1 ? floatValue : floatValue * Math.PI / 180;
}
function _validateTransforms(transform) {
  transform.forEach(function (transformation) {
    var keys = Object.keys(transformation);
    invariant(keys.length === 1, 'You must specify exactly one property per transform object. Passed properties: %s', stringifySafe(transformation));
    var key = keys[0];
    var value = transformation[key];
    _validateTransform(key, value, transformation);
  });
}
function _validateTransform(key, value, transformation) {
  invariant(!value.getValue, 'You passed an Animated.Value to a normal component. ' + 'You need to wrap that component in an Animated. For example, ' + 'replace <View /> by <Animated.View />.');
  var multivalueTransforms = ['matrix', 'translate'];
  if (multivalueTransforms.indexOf(key) !== -1) {
    invariant(Array.isArray(value), 'Transform with key of %s must have an array as the value: %s', key, stringifySafe(transformation));
  }
  switch (key) {
    case 'matrix':
      invariant(value.length === 9 || value.length === 16, 'Matrix transform must have a length of 9 (2d) or 16 (3d). ' + 'Provided matrix has a length of %s: %s', value.length, stringifySafe(transformation));
      break;
    case 'translate':
      invariant(value.length === 2 || value.length === 3, 'Transform with key translate must be an array of length 2 or 3, found %s: %s', value.length, stringifySafe(transformation));
      break;
    case 'rotateX':
    case 'rotateY':
    case 'rotateZ':
    case 'rotate':
    case 'skewX':
    case 'skewY':
      invariant(typeof value === 'string', 'Transform with key of "%s" must be a string: %s', key, stringifySafe(transformation));
      invariant(value.indexOf('deg') > -1 || value.indexOf('rad') > -1, 'Rotate transform must be expressed in degrees (deg) or radians ' + '(rad): %s', stringifySafe(transformation));
      break;
    case 'perspective':
      invariant(typeof value === 'number', 'Transform with key of "%s" must be a number: %s', key, stringifySafe(transformation));
      invariant(value !== 0, 'Transform with key of "%s" cannot be zero: %s', key, stringifySafe(transformation));
      break;
    case 'translateX':
    case 'translateY':
    case 'scale':
    case 'scaleX':
    case 'scaleY':
      invariant(typeof value === 'number', 'Transform with key of "%s" must be a number: %s', key, stringifySafe(transformation));
      break;
    default:
      invariant(false, 'Invalid transform %s: %s', key, stringifySafe(transformation));
  }
}
module.exports = processTransform;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYXRyaXhNYXRoIiwicmVxdWlyZSIsIlBsYXRmb3JtIiwiaW52YXJpYW50Iiwic3RyaW5naWZ5U2FmZSIsImRlZmF1bHQiLCJwcm9jZXNzVHJhbnNmb3JtIiwidHJhbnNmb3JtIiwiX19ERVZfXyIsIl92YWxpZGF0ZVRyYW5zZm9ybXMiLCJPUyIsInJlc3VsdCIsImNyZWF0ZUlkZW50aXR5TWF0cml4IiwiZm9yRWFjaCIsInRyYW5zZm9ybWF0aW9uIiwia2V5IiwiT2JqZWN0Iiwia2V5cyIsInZhbHVlIiwibXVsdGlwbHlJbnRvIiwiX211bHRpcGx5VHJhbnNmb3JtIiwicmV1c2VQZXJzcGVjdGl2ZUNvbW1hbmQiLCJyZXVzZVJvdGF0ZVhDb21tYW5kIiwiX2NvbnZlcnRUb1JhZGlhbnMiLCJyZXVzZVJvdGF0ZVlDb21tYW5kIiwicmV1c2VSb3RhdGVaQ29tbWFuZCIsInJldXNlU2NhbGVDb21tYW5kIiwicmV1c2VTY2FsZVhDb21tYW5kIiwicmV1c2VTY2FsZVlDb21tYW5kIiwicmV1c2VUcmFuc2xhdGUzZENvbW1hbmQiLCJyZXVzZVRyYW5zbGF0ZTJkQ29tbWFuZCIsInJldXNlU2tld1hDb21tYW5kIiwicmV1c2VTa2V3WUNvbW1hbmQiLCJFcnJvciIsIm1hdHJpeE1hdGhGdW5jdGlvbiIsImFyZ3MiLCJtYXRyaXhUb0FwcGx5IiwiYXJnc1dpdGhJZGVudGl0eSIsImNvbmNhdCIsImFwcGx5IiwiZmxvYXRWYWx1ZSIsInBhcnNlRmxvYXQiLCJpbmRleE9mIiwiTWF0aCIsIlBJIiwibGVuZ3RoIiwiX3ZhbGlkYXRlVHJhbnNmb3JtIiwiZ2V0VmFsdWUiLCJtdWx0aXZhbHVlVHJhbnNmb3JtcyIsIkFycmF5IiwiaXNBcnJheSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJwcm9jZXNzVHJhbnNmb3JtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvd1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgTWF0cml4TWF0aCA9IHJlcXVpcmUoJy4uL1V0aWxpdGllcy9NYXRyaXhNYXRoJyk7XG5jb25zdCBQbGF0Zm9ybSA9IHJlcXVpcmUoJy4uL1V0aWxpdGllcy9QbGF0Zm9ybScpO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdpbnZhcmlhbnQnKTtcbmNvbnN0IHN0cmluZ2lmeVNhZmUgPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvc3RyaW5naWZ5U2FmZScpLmRlZmF1bHQ7XG5cbi8qKlxuICogR2VuZXJhdGUgYSB0cmFuc2Zvcm0gbWF0cml4IGJhc2VkIG9uIHRoZSBwcm92aWRlZCB0cmFuc2Zvcm1zLCBhbmQgdXNlIHRoYXRcbiAqIHdpdGhpbiB0aGUgc3R5bGUgb2JqZWN0IGluc3RlYWQuXG4gKlxuICogVGhpcyBhbGxvd3MgdXMgdG8gcHJvdmlkZSBhbiBBUEkgdGhhdCBpcyBzaW1pbGFyIHRvIENTUywgd2hlcmUgdHJhbnNmb3JtcyBtYXlcbiAqIGJlIGFwcGxpZWQgaW4gYW4gYXJiaXRyYXJ5IG9yZGVyLCBhbmQgeWV0IGhhdmUgYSB1bml2ZXJzYWwsIHNpbmd1bGFyXG4gKiBpbnRlcmZhY2UgdG8gbmF0aXZlIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NUcmFuc2Zvcm0oXG4gIHRyYW5zZm9ybTogQXJyYXk8T2JqZWN0Pixcbik6IEFycmF5PE9iamVjdD4gfCBBcnJheTxudW1iZXI+IHtcbiAgaWYgKF9fREVWX18pIHtcbiAgICBfdmFsaWRhdGVUcmFuc2Zvcm1zKHRyYW5zZm9ybSk7XG4gIH1cblxuICAvLyBBbmRyb2lkICYgaU9TIGltcGxlbWVudGF0aW9ucyBvZiB0cmFuc2Zvcm0gcHJvcGVydHkgYWNjZXB0IHRoZSBsaXN0IG9mXG4gIC8vIHRyYW5zZm9ybSBwcm9wZXJ0aWVzIGFzIG9wcG9zZWQgdG8gYSB0cmFuc2Zvcm0gTWF0cml4LiBUaGlzIGlzIG5lY2Vzc2FyeVxuICAvLyB0byBjb250cm9sIHRyYW5zZm9ybSBwcm9wZXJ0eSB1cGRhdGVzIGNvbXBsZXRlbHkgb24gdGhlIG5hdGl2ZSB0aHJlYWQuXG4gIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnIHx8IFBsYXRmb3JtLk9TID09PSAnaW9zJykge1xuICAgIHJldHVybiB0cmFuc2Zvcm07XG4gIH1cblxuICBjb25zdCByZXN1bHQgPSBNYXRyaXhNYXRoLmNyZWF0ZUlkZW50aXR5TWF0cml4KCk7XG5cbiAgdHJhbnNmb3JtLmZvckVhY2godHJhbnNmb3JtYXRpb24gPT4ge1xuICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHRyYW5zZm9ybWF0aW9uKVswXTtcbiAgICBjb25zdCB2YWx1ZSA9IHRyYW5zZm9ybWF0aW9uW2tleV07XG5cbiAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgY2FzZSAnbWF0cml4JzpcbiAgICAgICAgTWF0cml4TWF0aC5tdWx0aXBseUludG8ocmVzdWx0LCByZXN1bHQsIHZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdwZXJzcGVjdGl2ZSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VQZXJzcGVjdGl2ZUNvbW1hbmQsIFt2YWx1ZV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JvdGF0ZVgnOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlUm90YXRlWENvbW1hbmQsIFtcbiAgICAgICAgICBfY29udmVydFRvUmFkaWFucyh2YWx1ZSksXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JvdGF0ZVknOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlUm90YXRlWUNvbW1hbmQsIFtcbiAgICAgICAgICBfY29udmVydFRvUmFkaWFucyh2YWx1ZSksXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JvdGF0ZSc6XG4gICAgICBjYXNlICdyb3RhdGVaJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVJvdGF0ZVpDb21tYW5kLCBbXG4gICAgICAgICAgX2NvbnZlcnRUb1JhZGlhbnModmFsdWUpLFxuICAgICAgICBdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzY2FsZSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTY2FsZUNvbW1hbmQsIFt2YWx1ZV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NjYWxlWCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTY2FsZVhDb21tYW5kLCBbdmFsdWVdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzY2FsZVknOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlU2NhbGVZQ29tbWFuZCwgW3ZhbHVlXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndHJhbnNsYXRlJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVRyYW5zbGF0ZTNkQ29tbWFuZCwgW1xuICAgICAgICAgIHZhbHVlWzBdLFxuICAgICAgICAgIHZhbHVlWzFdLFxuICAgICAgICAgIHZhbHVlWzJdIHx8IDAsXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RyYW5zbGF0ZVgnOlxuICAgICAgICBfbXVsdGlwbHlUcmFuc2Zvcm0ocmVzdWx0LCBNYXRyaXhNYXRoLnJldXNlVHJhbnNsYXRlMmRDb21tYW5kLCBbXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgMCxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndHJhbnNsYXRlWSc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VUcmFuc2xhdGUyZENvbW1hbmQsIFtcbiAgICAgICAgICAwLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICBdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdza2V3WCc6XG4gICAgICAgIF9tdWx0aXBseVRyYW5zZm9ybShyZXN1bHQsIE1hdHJpeE1hdGgucmV1c2VTa2V3WENvbW1hbmQsIFtcbiAgICAgICAgICBfY29udmVydFRvUmFkaWFucyh2YWx1ZSksXG4gICAgICAgIF0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NrZXdZJzpcbiAgICAgICAgX211bHRpcGx5VHJhbnNmb3JtKHJlc3VsdCwgTWF0cml4TWF0aC5yZXVzZVNrZXdZQ29tbWFuZCwgW1xuICAgICAgICAgIF9jb252ZXJ0VG9SYWRpYW5zKHZhbHVlKSxcbiAgICAgICAgXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRyYW5zZm9ybSBuYW1lOiAnICsga2V5KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogUGVyZm9ybXMgYSBkZXN0cnVjdGl2ZSBvcGVyYXRpb24gb24gYSB0cmFuc2Zvcm0gbWF0cml4LlxuICovXG5mdW5jdGlvbiBfbXVsdGlwbHlUcmFuc2Zvcm0oXG4gIHJlc3VsdDogQXJyYXk8bnVtYmVyPixcbiAgbWF0cml4TWF0aEZ1bmN0aW9uOiBGdW5jdGlvbixcbiAgYXJnczogQXJyYXk8bnVtYmVyPixcbik6IHZvaWQge1xuICBjb25zdCBtYXRyaXhUb0FwcGx5ID0gTWF0cml4TWF0aC5jcmVhdGVJZGVudGl0eU1hdHJpeCgpO1xuICBjb25zdCBhcmdzV2l0aElkZW50aXR5ID0gW21hdHJpeFRvQXBwbHldLmNvbmNhdChhcmdzKTtcbiAgbWF0cml4TWF0aEZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3NXaXRoSWRlbnRpdHkpO1xuICBNYXRyaXhNYXRoLm11bHRpcGx5SW50byhyZXN1bHQsIHJlc3VsdCwgbWF0cml4VG9BcHBseSk7XG59XG5cbi8qKlxuICogUGFyc2VzIGEgc3RyaW5nIGxpa2UgJzAuNXJhZCcgb3IgJzYwZGVnJyBpbnRvIHJhZGlhbnMgZXhwcmVzc2VkIGluIGEgZmxvYXQuXG4gKiBOb3RlIHRoYXQgdmFsaWRhdGlvbiBvbiB0aGUgc3RyaW5nIGlzIGRvbmUgaW4gYF92YWxpZGF0ZVRyYW5zZm9ybSgpYC5cbiAqL1xuZnVuY3Rpb24gX2NvbnZlcnRUb1JhZGlhbnModmFsdWU6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlLmluZGV4T2YoJ3JhZCcpID4gLTEgPyBmbG9hdFZhbHVlIDogKGZsb2F0VmFsdWUgKiBNYXRoLlBJKSAvIDE4MDtcbn1cblxuZnVuY3Rpb24gX3ZhbGlkYXRlVHJhbnNmb3Jtcyh0cmFuc2Zvcm06IEFycmF5PE9iamVjdD4pOiB2b2lkIHtcbiAgdHJhbnNmb3JtLmZvckVhY2godHJhbnNmb3JtYXRpb24gPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0cmFuc2Zvcm1hdGlvbik7XG4gICAgaW52YXJpYW50KFxuICAgICAga2V5cy5sZW5ndGggPT09IDEsXG4gICAgICAnWW91IG11c3Qgc3BlY2lmeSBleGFjdGx5IG9uZSBwcm9wZXJ0eSBwZXIgdHJhbnNmb3JtIG9iamVjdC4gUGFzc2VkIHByb3BlcnRpZXM6ICVzJyxcbiAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICk7XG4gICAgY29uc3Qga2V5ID0ga2V5c1swXTtcbiAgICBjb25zdCB2YWx1ZSA9IHRyYW5zZm9ybWF0aW9uW2tleV07XG4gICAgX3ZhbGlkYXRlVHJhbnNmb3JtKGtleSwgdmFsdWUsIHRyYW5zZm9ybWF0aW9uKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIF92YWxpZGF0ZVRyYW5zZm9ybShcbiAga2V5OlxuICAgIHwgc3RyaW5nXG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwnbWF0cml4Jz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdwZXJzcGVjdGl2ZSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwncm90YXRlJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVZJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdyb3RhdGVaJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdzY2FsZSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwnc2NhbGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdzY2FsZVknPlxuICAgIHwgJFRFTVBPUkFSWSRzdHJpbmc8J3NrZXdYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCdza2V3WSc+XG4gICAgfCAkVEVNUE9SQVJZJHN0cmluZzwndHJhbnNsYXRlJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCd0cmFuc2xhdGVYJz5cbiAgICB8ICRURU1QT1JBUlkkc3RyaW5nPCd0cmFuc2xhdGVZJz4sXG4gIHZhbHVlOiBhbnkgfCBudW1iZXIgfCBzdHJpbmcsXG4gIHRyYW5zZm9ybWF0aW9uOiBhbnksXG4pIHtcbiAgaW52YXJpYW50KFxuICAgICF2YWx1ZS5nZXRWYWx1ZSxcbiAgICAnWW91IHBhc3NlZCBhbiBBbmltYXRlZC5WYWx1ZSB0byBhIG5vcm1hbCBjb21wb25lbnQuICcgK1xuICAgICAgJ1lvdSBuZWVkIHRvIHdyYXAgdGhhdCBjb21wb25lbnQgaW4gYW4gQW5pbWF0ZWQuIEZvciBleGFtcGxlLCAnICtcbiAgICAgICdyZXBsYWNlIDxWaWV3IC8+IGJ5IDxBbmltYXRlZC5WaWV3IC8+LicsXG4gICk7XG5cbiAgY29uc3QgbXVsdGl2YWx1ZVRyYW5zZm9ybXMgPSBbJ21hdHJpeCcsICd0cmFuc2xhdGUnXTtcbiAgaWYgKG11bHRpdmFsdWVUcmFuc2Zvcm1zLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBBcnJheS5pc0FycmF5KHZhbHVlKSxcbiAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgb2YgJXMgbXVzdCBoYXZlIGFuIGFycmF5IGFzIHRoZSB2YWx1ZTogJXMnLFxuICAgICAga2V5LFxuICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgKTtcbiAgfVxuICBzd2l0Y2ggKGtleSkge1xuICAgIGNhc2UgJ21hdHJpeCc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmxlbmd0aCA9PT0gOSB8fCB2YWx1ZS5sZW5ndGggPT09IDE2LFxuICAgICAgICAnTWF0cml4IHRyYW5zZm9ybSBtdXN0IGhhdmUgYSBsZW5ndGggb2YgOSAoMmQpIG9yIDE2ICgzZCkuICcgK1xuICAgICAgICAgICdQcm92aWRlZCBtYXRyaXggaGFzIGEgbGVuZ3RoIG9mICVzOiAlcycsXG4gICAgICAgIC8qICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSAoPj0wLjg0LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXNcbiAgICAgICAgICogY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC44NCB3YXMgZGVwbG95ZWQuIFRvXG4gICAgICAgICAqIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICB2YWx1ZS5sZW5ndGgsXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RyYW5zbGF0ZSc6XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHZhbHVlLmxlbmd0aCA9PT0gMiB8fCB2YWx1ZS5sZW5ndGggPT09IDMsXG4gICAgICAgICdUcmFuc2Zvcm0gd2l0aCBrZXkgdHJhbnNsYXRlIG11c3QgYmUgYW4gYXJyYXkgb2YgbGVuZ3RoIDIgb3IgMywgZm91bmQgJXM6ICVzJyxcbiAgICAgICAgLyogJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddICg+PTAuODQuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICAgKiBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjg0IHdhcyBkZXBsb3llZC4gVG9cbiAgICAgICAgICogc2VlIHRoZSBlcnJvciwgZGVsZXRlIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgICAgIHZhbHVlLmxlbmd0aCxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncm90YXRlWCc6XG4gICAgY2FzZSAncm90YXRlWSc6XG4gICAgY2FzZSAncm90YXRlWic6XG4gICAgY2FzZSAncm90YXRlJzpcbiAgICBjYXNlICdza2V3WCc6XG4gICAgY2FzZSAnc2tld1knOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgc3RyaW5nOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICB2YWx1ZS5pbmRleE9mKCdkZWcnKSA+IC0xIHx8IHZhbHVlLmluZGV4T2YoJ3JhZCcpID4gLTEsXG4gICAgICAgICdSb3RhdGUgdHJhbnNmb3JtIG11c3QgYmUgZXhwcmVzc2VkIGluIGRlZ3JlZXMgKGRlZykgb3IgcmFkaWFucyAnICtcbiAgICAgICAgICAnKHJhZCk6ICVzJyxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncGVyc3BlY3RpdmUnOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgbnVtYmVyOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICB2YWx1ZSAhPT0gMCxcbiAgICAgICAgJ1RyYW5zZm9ybSB3aXRoIGtleSBvZiBcIiVzXCIgY2Fubm90IGJlIHplcm86ICVzJyxcbiAgICAgICAga2V5LFxuICAgICAgICBzdHJpbmdpZnlTYWZlKHRyYW5zZm9ybWF0aW9uKSxcbiAgICAgICk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICd0cmFuc2xhdGVYJzpcbiAgICBjYXNlICd0cmFuc2xhdGVZJzpcbiAgICBjYXNlICdzY2FsZSc6XG4gICAgY2FzZSAnc2NhbGVYJzpcbiAgICBjYXNlICdzY2FsZVknOlxuICAgICAgaW52YXJpYW50KFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInLFxuICAgICAgICAnVHJhbnNmb3JtIHdpdGgga2V5IG9mIFwiJXNcIiBtdXN0IGJlIGEgbnVtYmVyOiAlcycsXG4gICAgICAgIGtleSxcbiAgICAgICAgc3RyaW5naWZ5U2FmZSh0cmFuc2Zvcm1hdGlvbiksXG4gICAgICApO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgZmFsc2UsXG4gICAgICAgICdJbnZhbGlkIHRyYW5zZm9ybSAlczogJXMnLFxuICAgICAgICBrZXksXG4gICAgICAgIHN0cmluZ2lmeVNhZmUodHJhbnNmb3JtYXRpb24pLFxuICAgICAgKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHByb2Nlc3NUcmFuc2Zvcm07XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBRVosSUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMseUJBQXlCLENBQUM7QUFDckQsSUFBTUMsUUFBUSxHQUFHRCxPQUFPLENBQUMsdUJBQXVCLENBQUM7QUFFakQsSUFBTUUsU0FBUyxHQUFHRixPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3RDLElBQU1HLGFBQWEsR0FBR0gsT0FBTyxDQUFDLDRCQUE0QixDQUFDLENBQUNJLE9BQU87QUFVbkUsU0FBU0MsZ0JBQWdCQSxDQUN2QkMsU0FBd0IsRUFDTztFQUMvQixJQUFJQyxPQUFPLEVBQUU7SUFDWEMsbUJBQW1CLENBQUNGLFNBQVMsQ0FBQztFQUNoQztFQUtBLElBQUlMLFFBQVEsQ0FBQ1EsRUFBRSxLQUFLLFNBQVMsSUFBSVIsUUFBUSxDQUFDUSxFQUFFLEtBQUssS0FBSyxFQUFFO0lBQ3RELE9BQU9ILFNBQVM7RUFDbEI7RUFFQSxJQUFNSSxNQUFNLEdBQUdYLFVBQVUsQ0FBQ1ksb0JBQW9CLEVBQUU7RUFFaERMLFNBQVMsQ0FBQ00sT0FBTyxDQUFDLFVBQUFDLGNBQWMsRUFBSTtJQUNsQyxJQUFNQyxHQUFHLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDSCxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDMUMsSUFBTUksS0FBSyxHQUFHSixjQUFjLENBQUNDLEdBQUcsQ0FBQztJQUVqQyxRQUFRQSxHQUFHO01BQ1QsS0FBSyxRQUFRO1FBQ1hmLFVBQVUsQ0FBQ21CLFlBQVksQ0FBQ1IsTUFBTSxFQUFFQSxNQUFNLEVBQUVPLEtBQUssQ0FBQztRQUM5QztNQUNGLEtBQUssYUFBYTtRQUNoQkUsa0JBQWtCLENBQUNULE1BQU0sRUFBRVgsVUFBVSxDQUFD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