817c18cbdc7de042c07202ccb35f7dba
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }
function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
var _require = require('../AnimatedEvent'),
  AnimatedEvent = _require.AnimatedEvent;
var AnimatedNode = require('./AnimatedNode');
var AnimatedStyle = require('./AnimatedStyle');
var NativeAnimatedHelper = require('../NativeAnimatedHelper');
var ReactNative = require('../../Renderer/shims/ReactNative');
var invariant = require('invariant');
var AnimatedProps = function (_AnimatedNode) {
  (0, _inherits2.default)(AnimatedProps, _AnimatedNode);
  var _super = _createSuper(AnimatedProps);
  function AnimatedProps(props, callback) {
    var _this;
    (0, _classCallCheck2.default)(this, AnimatedProps);
    _this = _super.call(this);
    if (props.style) {
      props = Object.assign({}, props, {
        style: new AnimatedStyle(props.style)
      });
    }
    _this._props = props;
    _this._callback = callback;
    return _this;
  }
  (0, _createClass2.default)(AnimatedProps, [{
    key: "__getValue",
    value: function __getValue() {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          if (!value.__isNative || value instanceof AnimatedStyle) {
            props[key] = value.__getValue();
          }
        } else if (value instanceof AnimatedEvent) {
          props[key] = value.__getHandler();
        } else {
          props[key] = value;
        }
      }
      return props;
    }
  }, {
    key: "__getAnimatedValue",
    value: function __getAnimatedValue() {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          props[key] = value.__getAnimatedValue();
        }
      }
      return props;
    }
  }, {
    key: "__attach",
    value: function __attach() {
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          value.__addChild(this);
        }
      }
    }
  }, {
    key: "__detach",
    value: function __detach() {
      if (this.__isNative && this._animatedView) {
        this.__disconnectAnimatedView();
      }
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof AnimatedNode) {
          value.__removeChild(this);
        }
      }
      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedProps.prototype), "__detach", this).call(this);
    }
  }, {
    key: "update",
    value: function update() {
      this._callback();
    }
  }, {
    key: "__makeNative",
    value: function __makeNative(platformConfig) {
      if (!this.__isNative) {
        this.__isNative = true;
        for (var key in this._props) {
          var value = this._props[key];
          if (value instanceof AnimatedNode) {
            value.__makeNative(platformConfig);
          }
        }
        (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedProps.prototype), "__setPlatformConfig", this).call(this, platformConfig);
        if (this._animatedView) {
          this.__connectAnimatedView();
        }
      }
    }
  }, {
    key: "setNativeView",
    value: function setNativeView(animatedView) {
      if (this._animatedView === animatedView) {
        return;
      }
      this._animatedView = animatedView;
      if (this.__isNative) {
        this.__connectAnimatedView();
      }
    }
  }, {
    key: "__connectAnimatedView",
    value: function __connectAnimatedView() {
      invariant(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = ReactNative.findNodeHandle(this._animatedView);
      invariant(nativeViewTag != null, 'Unable to locate attached view in the native tree');
      NativeAnimatedHelper.API.connectAnimatedNodeToView(this.__getNativeTag(), nativeViewTag);
    }
  }, {
    key: "__disconnectAnimatedView",
    value: function __disconnectAnimatedView() {
      invariant(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = ReactNative.findNodeHandle(this._animatedView);
      invariant(nativeViewTag != null, 'Unable to locate attached view in the native tree');
      NativeAnimatedHelper.API.disconnectAnimatedNodeFromView(this.__getNativeTag(), nativeViewTag);
    }
  }, {
    key: "__restoreDefaultValues",
    value: function __restoreDefaultValues() {
      if (this.__isNative) {
        NativeAnimatedHelper.API.restoreDefaultValues(this.__getNativeTag());
      }
    }
  }, {
    key: "__getNativeConfig",
    value: function __getNativeConfig() {
      var propsConfig = {};
      for (var propKey in this._props) {
        var value = this._props[propKey];
        if (value instanceof AnimatedNode) {
          value.__makeNative(this.__getPlatformConfig());
          propsConfig[propKey] = value.__getNativeTag();
        }
      }
      return {
        type: 'props',
        props: propsConfig
      };
    }
  }]);
  return AnimatedProps;
}(AnimatedNode);
module.exports = AnimatedProps;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX2dldDIiLCJfaW5oZXJpdHMyIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yIiwiX2dldFByb3RvdHlwZU9mMiIsIl9jcmVhdGVTdXBlciIsIkRlcml2ZWQiLCJoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIl9jcmVhdGVTdXBlckludGVybmFsIiwiU3VwZXIiLCJkZWZhdWx0IiwicmVzdWx0IiwiTmV3VGFyZ2V0IiwiY29uc3RydWN0b3IiLCJSZWZsZWN0IiwiY29uc3RydWN0IiwiYXJndW1lbnRzIiwiYXBwbHkiLCJzaGFtIiwiUHJveHkiLCJCb29sZWFuIiwicHJvdG90eXBlIiwidmFsdWVPZiIsImNhbGwiLCJlIiwiX3JlcXVpcmUiLCJBbmltYXRlZEV2ZW50IiwiQW5pbWF0ZWROb2RlIiwiQW5pbWF0ZWRTdHlsZSIsIk5hdGl2ZUFuaW1hdGVkSGVscGVyIiwiUmVhY3ROYXRpdmUiLCJpbnZhcmlhbnQiLCJBbmltYXRlZFByb3BzIiwiX0FuaW1hdGVkTm9kZSIsIl9zdXBlciIsInByb3BzIiwiY2FsbGJhY2siLCJfdGhpcyIsInN0eWxlIiwiT2JqZWN0IiwiYXNzaWduIiwiX3Byb3BzIiwiX2NhbGxiYWNrIiwia2V5IiwidmFsdWUiLCJfX2dldFZhbHVlIiwiX19pc05hdGl2ZSIsIl9fZ2V0SGFuZGxlciIsIl9fZ2V0QW5pbWF0ZWRWYWx1ZSIsIl9fYXR0YWNoIiwiX19hZGRDaGlsZCIsIl9fZGV0YWNoIiwiX2FuaW1hdGVkVmlldyIsIl9fZGlzY29ubmVjdEFuaW1hdGVkVmlldyIsIl9fcmVtb3ZlQ2hpbGQiLCJ1cGRhdGUiLCJfX21ha2VOYXRpdmUiLCJwbGF0Zm9ybUNvbmZpZyIsIl9fY29ubmVjdEFuaW1hdGVkVmlldyIsInNldE5hdGl2ZVZpZXciLCJhbmltYXRlZFZpZXciLCJuYXRpdmVWaWV3VGFnIiwiZmluZE5vZGVIYW5kbGUiLCJBUEkiLCJjb25uZWN0QW5pbWF0ZWROb2RlVG9WaWV3IiwiX19nZXROYXRpdmVUYWciLCJkaXNjb25uZWN0QW5pbWF0ZWROb2RlRnJvbVZpZXciLCJfX3Jlc3RvcmVEZWZhdWx0VmFsdWVzIiwicmVzdG9yZURlZmF1bHRWYWx1ZXMiLCJfX2dldE5hdGl2ZUNvbmZpZyIsInByb3BzQ29uZmlnIiwicHJvcEtleSIsIl9fZ2V0UGxhdGZvcm1Db25maWciLCJ0eXBlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkFuaW1hdGVkUHJvcHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCB7QW5pbWF0ZWRFdmVudH0gPSByZXF1aXJlKCcuLi9BbmltYXRlZEV2ZW50Jyk7XG5jb25zdCBBbmltYXRlZE5vZGUgPSByZXF1aXJlKCcuL0FuaW1hdGVkTm9kZScpO1xuY29uc3QgQW5pbWF0ZWRTdHlsZSA9IHJlcXVpcmUoJy4vQW5pbWF0ZWRTdHlsZScpO1xuY29uc3QgTmF0aXZlQW5pbWF0ZWRIZWxwZXIgPSByZXF1aXJlKCcuLi9OYXRpdmVBbmltYXRlZEhlbHBlcicpO1xuY29uc3QgUmVhY3ROYXRpdmUgPSByZXF1aXJlKCcuLi8uLi9SZW5kZXJlci9zaGltcy9SZWFjdE5hdGl2ZScpO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdpbnZhcmlhbnQnKTtcblxuaW1wb3J0IHR5cGUge1BsYXRmb3JtQ29uZmlnfSBmcm9tICcuLi9BbmltYXRlZFBsYXRmb3JtQ29uZmlnJztcblxuY2xhc3MgQW5pbWF0ZWRQcm9wcyBleHRlbmRzIEFuaW1hdGVkTm9kZSB7XG4gIF9wcm9wczogT2JqZWN0O1xuICBfYW5pbWF0ZWRWaWV3OiBhbnk7XG4gIF9jYWxsYmFjazogKCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogT2JqZWN0LCBjYWxsYmFjazogKCkgPT4gdm9pZCkge1xuICAgIHN1cGVyKCk7XG4gICAgaWYgKHByb3BzLnN0eWxlKSB7XG4gICAgICBwcm9wcyA9IHtcbiAgICAgICAgLi4ucHJvcHMsXG4gICAgICAgIHN0eWxlOiBuZXcgQW5pbWF0ZWRTdHlsZShwcm9wcy5zdHlsZSksXG4gICAgICB9O1xuICAgIH1cbiAgICB0aGlzLl9wcm9wcyA9IHByb3BzO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICBfX2dldFZhbHVlKCk6IE9iamVjdCB7XG4gICAgY29uc3QgcHJvcHMgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLl9wcm9wcykge1xuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9wcm9wc1trZXldO1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWROb2RlKSB7XG4gICAgICAgIGlmICghdmFsdWUuX19pc05hdGl2ZSB8fCB2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkU3R5bGUpIHtcbiAgICAgICAgICAvLyBXZSBjYW5ub3QgdXNlIHZhbHVlIG9mIG5hdGl2ZWx5IGRyaXZlbiBub2RlcyB0aGlzIHdheSBhcyB0aGUgdmFsdWUgd2UgaGF2ZSBhY2Nlc3MgZnJvbVxuICAgICAgICAgIC8vIEpTIG1heSBub3QgYmUgdXAgdG8gZGF0ZS5cbiAgICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRWYWx1ZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWRFdmVudCkge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRIYW5kbGVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIF9fZ2V0QW5pbWF0ZWRWYWx1ZSgpOiBPYmplY3Qge1xuICAgIGNvbnN0IHByb3BzID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRBbmltYXRlZFZhbHVlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIF9fYXR0YWNoKCk6IHZvaWQge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgdmFsdWUuX19hZGRDaGlsZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfX2RldGFjaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fX2lzTmF0aXZlICYmIHRoaXMuX2FuaW1hdGVkVmlldykge1xuICAgICAgdGhpcy5fX2Rpc2Nvbm5lY3RBbmltYXRlZFZpZXcoKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICB2YWx1ZS5fX3JlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlci5fX2RldGFjaCgpO1xuICB9XG5cbiAgdXBkYXRlKCk6IHZvaWQge1xuICAgIHRoaXMuX2NhbGxiYWNrKCk7XG4gIH1cblxuICBfX21ha2VOYXRpdmUocGxhdGZvcm1Db25maWc6ID9QbGF0Zm9ybUNvbmZpZyk6IHZvaWQge1xuICAgIGlmICghdGhpcy5fX2lzTmF0aXZlKSB7XG4gICAgICB0aGlzLl9faXNOYXRpdmUgPSB0cnVlO1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9wcm9wc1trZXldO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgICB2YWx1ZS5fX21ha2VOYXRpdmUocGxhdGZvcm1Db25maWcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFNpbmNlIHRoaXMgZG9lcyBub3QgY2FsbCB0aGUgc3VwZXIuX19tYWtlTmF0aXZlLCB3ZSBuZWVkIHRvIHN0b3JlIHRoZVxuICAgICAgLy8gc3VwcGxpZWQgcGxhdGZvcm1Db25maWcgaGVyZSwgYmVmb3JlIGNhbGxpbmcgX19jb25uZWN0QW5pbWF0ZWRWaWV3XG4gICAgICAvLyB3aGVyZSBpdCB3aWxsIGJlIG5lZWRlZCB0byB0cmF2ZXJzZSB0aGUgZ3JhcGggb2YgYXR0YWNoZWQgdmFsdWVzLlxuICAgICAgc3VwZXIuX19zZXRQbGF0Zm9ybUNvbmZpZyhwbGF0Zm9ybUNvbmZpZyk7XG5cbiAgICAgIGlmICh0aGlzLl9hbmltYXRlZFZpZXcpIHtcbiAgICAgICAgdGhpcy5fX2Nvbm5lY3RBbmltYXRlZFZpZXcoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXROYXRpdmVWaWV3KGFuaW1hdGVkVmlldzogYW55KTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX2FuaW1hdGVkVmlldyA9PT0gYW5pbWF0ZWRWaWV3KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2FuaW1hdGVkVmlldyA9IGFuaW1hdGVkVmlldztcbiAgICBpZiAodGhpcy5fX2lzTmF0aXZlKSB7XG4gICAgICB0aGlzLl9fY29ubmVjdEFuaW1hdGVkVmlldygpO1xuICAgIH1cbiAgfVxuXG4gIF9fY29ubmVjdEFuaW1hdGVkVmlldygpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQodGhpcy5fX2lzTmF0aXZlLCAnRXhwZWN0ZWQgbm9kZSB0byBiZSBtYXJrZWQgYXMgXCJuYXRpdmVcIicpO1xuICAgIGNvbnN0IG5hdGl2ZVZpZXdUYWc6ID9udW1iZXIgPSBSZWFjdE5hdGl2ZS5maW5kTm9kZUhhbmRsZShcbiAgICAgIHRoaXMuX2FuaW1hdGVkVmlldyxcbiAgICApO1xuICAgIGludmFyaWFudChcbiAgICAgIG5hdGl2ZVZpZXdUYWcgIT0gbnVsbCxcbiAgICAgICdVbmFibGUgdG8gbG9jYXRlIGF0dGFjaGVkIHZpZXcgaW4gdGhlIG5hdGl2ZSB0cmVlJyxcbiAgICApO1xuICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5jb25uZWN0QW5pbWF0ZWROb2RlVG9WaWV3KFxuICAgICAgdGhpcy5fX2dldE5hdGl2ZVRhZygpLFxuICAgICAgbmF0aXZlVmlld1RhZyxcbiAgICApO1xuICB9XG5cbiAgX19kaXNjb25uZWN0QW5pbWF0ZWRWaWV3KCk6IHZvaWQge1xuICAgIGludmFyaWFudCh0aGlzLl9faXNOYXRpdmUsICdFeHBlY3RlZCBub2RlIHRvIGJlIG1hcmtlZCBhcyBcIm5hdGl2ZVwiJyk7XG4gICAgY29uc3QgbmF0aXZlVmlld1RhZzogP251bWJlciA9IFJlYWN0TmF0aXZlLmZpbmROb2RlSGFuZGxlKFxuICAgICAgdGhpcy5fYW5pbWF0ZWRWaWV3LFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgbmF0aXZlVmlld1RhZyAhPSBudWxsLFxuICAgICAgJ1VuYWJsZSB0byBsb2NhdGUgYXR0YWNoZWQgdmlldyBpbiB0aGUgbmF0aXZlIHRyZWUnLFxuICAgICk7XG4gICAgTmF0aXZlQW5pbWF0ZWRIZWxwZXIuQVBJLmRpc2Nvbm5lY3RBbmltYXRlZE5vZGVGcm9tVmlldyhcbiAgICAgIHRoaXMuX19nZXROYXRpdmVUYWcoKSxcbiAgICAgIG5hdGl2ZVZpZXdUYWcsXG4gICAgKTtcbiAgfVxuXG4gIF9fcmVzdG9yZURlZmF1bHRWYWx1ZXMoKTogdm9pZCB7XG4gICAgLy8gV2hlbiB1c2luZyB0aGUgbmF0aXZlIGRyaXZlciwgdmlldyBwcm9wZXJ0aWVzIG5lZWQgdG8gYmUgcmVzdG9yZWQgdG9cbiAgICAvLyB0aGVpciBkZWZhdWx0IHZhbHVlcyBtYW51YWxseSBzaW5jZSByZWFjdCBubyBsb25nZXIgdHJhY2tzIHRoZW0uIFRoaXNcbiAgICAvLyBpcyBuZWVkZWQgdG8gaGFuZGxlIGNhc2VzIHdoZXJlIGEgcHJvcCBkcml2ZW4gYnkgbmF0aXZlIGFuaW1hdGVkIGlzIHJlbW92ZWRcbiAgICAvLyBhZnRlciBoYXZpbmcgYmVlbiBjaGFuZ2VkIG5hdGl2ZWx5IGJ5IGFuIGFuaW1hdGlvbi5cbiAgICBpZiAodGhpcy5fX2lzTmF0aXZlKSB7XG4gICAgICBOYXRpdmVBbmltYXRlZEhlbHBlci5BUEkucmVzdG9yZURlZmF1bHRWYWx1ZXModGhpcy5fX2dldE5hdGl2ZVRhZygpKTtcbiAgICB9XG4gIH1cblxuICBfX2dldE5hdGl2ZUNvbmZpZygpOiBPYmplY3Qge1xuICAgIGNvbnN0IHByb3BzQ29uZmlnID0ge307XG4gICAgZm9yIChjb25zdCBwcm9wS2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW3Byb3BLZXldO1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQW5pbWF0ZWROb2RlKSB7XG4gICAgICAgIHZhbHVlLl9fbWFrZU5hdGl2ZSh0aGlzLl9fZ2V0UGxhdGZvcm1Db25maWcoKSk7XG4gICAgICAgIHByb3BzQ29uZmlnW3Byb3BLZXldID0gdmFsdWUuX19nZXROYXRpdmVUYWcoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdwcm9wcycsXG4gICAgICBwcm9wczogcHJvcHNDb25maWcsXG4gICAgfTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEFuaW1hdGVkUHJvcHM7XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBQUMsSUFBQUEsc0JBQUEsR0FBQUMsT0FBQTtBQUFBLElBQUFDLGdCQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBRSxhQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBRyxLQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBSSxVQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBSywyQkFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQU0sZ0JBQUEsR0FBQVAsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLFNBQUFPLGFBQUFDLE9BQUEsUUFBQUMseUJBQUEsR0FBQUMseUJBQUEsb0JBQUFDLHFCQUFBLFFBQUFDLEtBQUEsT0FBQU4sZ0JBQUEsQ0FBQU8sT0FBQSxFQUFBTCxPQUFBLEdBQUFNLE1BQUEsTUFBQUwseUJBQUEsUUFBQU0sU0FBQSxPQUFBVCxnQkFBQSxDQUFBTyxPQUFBLFFBQUFHLFdBQUEsRUFBQUYsTUFBQSxHQUFBRyxPQUFBLENBQUFDLFNBQUEsQ0FBQU4sS0FBQSxFQUFBTyxTQUFBLEVBQUFKLFNBQUEsWUFBQUQsTUFBQSxHQUFBRixLQUFBLENBQUFRLEtBQUEsT0FBQUQsU0FBQSxnQkFBQWQsMkJBQUEsQ0FBQVEsT0FBQSxRQUFBQyxNQUFBO0FBQUEsU0FBQUosMEJBQUEsZUFBQU8sT0FBQSxxQkFBQUEsT0FBQSxDQUFBQyxTQUFBLG9CQUFBRCxPQUFBLENBQUFDLFNBQUEsQ0FBQUcsSUFBQSwyQkFBQUMsS0FBQSxvQ0FBQUMsT0FBQSxDQUFBQyxTQUFBLENBQUFDLE9BQUEsQ0FBQUMsSUFBQSxDQUFBVCxPQUFBLENBQUFDLFNBQUEsQ0FBQUssT0FBQSw4Q0FBQUksQ0FBQTtB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